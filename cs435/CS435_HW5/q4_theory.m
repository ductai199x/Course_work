clear all;
P = [-1 1 1 -1; -1 -1 1 1; 1 1 1 1];
M = [0.866025403784439,-0.500000000000000,-2;0.500000000000000,0.866025403784439,1;0,0,1];
K = M * P;

A = zeros(8,9);

for i=1:4
    l = i*2;
    A(l-1,:) = [-P(1,i) -P(2,i) -1 0 0 0 K(1,i)*P(1,i) K(1,i)*P(2,i) K(1,i)];
    A(l,:) = [0 0 0 -P(1,i) -P(2,i) -1 K(2,i)*P(1,i) K(2,i)*P(2,i) K(2,i)];
end

[U, S, V] = svd(A);
H = reshape(V(:,9), 3, 3);

K_hom = H*P;

scatter(K(1,:), K(2,:));
hold on
scatter(K_hom(1,:), K_hom(2,:));